package com.arjun.interviewbit.perfect_peak;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;

/**
 * https://www.interviewbit.com/problems/perfect-peak-of-array/
 *
 * <p>This is a qualitative improvement over version 3. There is no extra space uses excpet the two
 * pointers making the space complexity as O(1). The time complexity is reduced to O(n) for most of
 * the cases. The minFromMaxGroup is calculated on a need basis when the element is iterated over.
 * The code is also straightforward.
 */
public class Solution3 {
  public int perfectPeak(ArrayList<Integer> A) {
    int isPerfectPeak = 0;

    int maxFromMinGroup = A.get(0);
    int minFromMaxGroup = A.get(1);
    for (int i = 1; i < A.size() - 1; i++) {
      Integer num = A.get(i);
      if (num == minFromMaxGroup) {
        minFromMaxGroup = Collections.min(A.subList(i + 1, A.size()));
      }
      if (maxFromMinGroup < num && minFromMaxGroup > num) {
        isPerfectPeak = 1;
        break;
      } else {
        if (num > maxFromMinGroup) maxFromMinGroup = num;
      }
    }

    return isPerfectPeak;
  }

  public static void main(String[] args) {
    int isPerfectPeak =
        new Solution3().perfectPeak(new ArrayList<>(Arrays.asList(5, 1, 4, 3, 6, 8, 10, 7, 9)));
    System.out.println(isPerfectPeak);

    isPerfectPeak = new Solution3().perfectPeak(new ArrayList<>(Arrays.asList(5, 1, 4, 4)));
    System.out.println(isPerfectPeak);

    isPerfectPeak =
        new Solution3()
            .perfectPeak(
                new ArrayList<>(
                    Arrays.asList(
                        5706, 26963, 24465, 29359, 16828, 26501, 28146, 18468, 9962, 2996, 492,
                        11479, 23282, 19170, 15725, 6335)));
    System.out.println(isPerfectPeak);

    isPerfectPeak =
        new Solution3()
            .perfectPeak(
                new ArrayList<>(
                    Arrays.asList(
                        9895, 30334, 17674, 23812, 20038, 25668, 6869, 1870, 4665, 27645, 7712,
                        17036, 31323, 8724, 28254, 28704, 26300, 25548, 15142, 12860, 19913, 32663,
                        32758)));
    System.out.println(isPerfectPeak);

    isPerfectPeak =
        new Solution3()
            .perfectPeak(
                new ArrayList<>(
                    Arrays.asList(
                        4844, 5046, 6181, 468, 5367, 4489, 4919, 266, 1491, 5650, 1330, 3659, 5913,
                        2944, 6211, 2629, 824, 1400, 5235, 6322, 126, 4001, 4257, 1370, 72, 5016,
                        4375, 3046, 4424, 4277, 6112, 1869, 1143, 743, 5150, 2476, 2409, 5333, 5381,
                        6222, 4455, 3472, 4537, 5020, 838, 2079, 1643, 5169, 4960, 4812, 1709, 2518,
                        2521, 5417, 5403, 2374, 1877, 3156, 5083, 1399, 4136, 921, 4671, 3475, 2558,
                        1770, 4258, 5924, 5988, 1410, 3432, 5294, 1959, 4421, 6012, 5835, 5358,
                        3376, 632, 6237, 1071, 4482, 4083, 4886, 3238, 358, 4719, 1192, 2169, 4914,
                        3465, 4052, 4288, 3452, 3259, 1355, 1540, 1001, 3479, 1967, 1086, 1615,
                        2180, 2420, 4771, 2515, 881, 948, 1757, 427, 2488, 716, 2016, 4798, 4649,
                        4473, 4037, 351, 1655, 4271, 1146, 2062, 3875, 4719, 2605, 3329, 3274, 4731,
                        3147, 5271, 93, 1235, 5397, 2419, 1978, 5392, 6641, 973, 1728, 2107, 2211,
                        2998, 2731, 5278, 100, 1942, 3803, 6251, 3069, 4869, 4644, 3142, 5178, 2921,
                        5134, 1596, 1395, 479, 2371, 2874, 2368, 5913, 1116, 1209, 4394, 3779, 3465,
                        1169, 6645, 4797, 5425, 1653, 4417, 5987, 3423, 4245, 6446, 5627, 2940,
                        3833, 887, 3805, 3672, 3236, 6494, 5274, 294, 5028, 1689, 4525, 5948, 4907,
                        6216, 5288, 2572, 6372, 4047, 5834, 4481, 2586, 6565, 5034, 2528, 2625,
                        6146, 5132, 844, 6142, 5212, 4226, 6339, 6178, 3422, 3454, 2232, 4473, 3094,
                        6460, 4311, 2522, 6406, 6144, 1317, 1027, 4408, 995, 2933, 2947, 3671, 4536,
                        5894, 6591, 6179, 1004, 2229, 1126, 3176, 5986, 5288, 1705, 4793, 225, 2279,
                        3599, 4166, 2713, 634, 3500, 5460, 5136, 1038, 6501, 2076, 4209, 298, 4075,
                        2462, 5233, 5106, 71, 5664, 3916, 994, 4649, 5855, 2944, 1603, 891, 3288,
                        4469, 4481, 5473, 5844, 1055, 76, 1638, 3626, 2214, 867, 3421, 5188, 5136,
                        2658, 654, 2470, 2234, 6349, 1392, 3773, 5780, 94, 3529, 520, 6592, 3640,
                        5435, 1666, 6088, 5062, 5098, 4575, 1000, 3540, 1726, 3608, 6550, 5781,
                        2138, 323, 6372, 4170, 1731, 1993, 6655, 790, 6416, 1076, 6622, 169, 1322,
                        1765, 1757, 841, 4535, 3673, 2852, 3284, 5204, 5194, 1616, 4279, 5370, 5264,
                        4214, 1791, 1725, 1831, 4189, 545, 4963, 2446, 3647, 3590, 3921, 6626, 5019,
                        6431, 1463, 5714, 5689, 6463, 3104, 5615, 4500, 6579, 241, 1834, 2483, 5949,
                        1343, 4726, 991, 6114, 5355, 5566, 748, 487, 5018, 3566, 5216, 4001, 5028,
                        450, 6405, 1563, 536, 4767, 6151, 2616, 5556, 5432, 3904, 5711, 1950, 4993,
                        2767, 6144, 5342, 6179, 117, 3873, 3078, 6111, 3562, 2628, 1217, 6260, 4808,
                        3236, 5754, 6125, 3243, 5286, 4969, 1861, 4112, 5120, 778, 6344, 3911, 5832,
                        2890, 2522, 3294, 667, 1830, 3921, 6434, 4359, 3508, 6233, 2470, 6083, 5258,
                        70, 5314, 4473, 2642, 2465, 895, 1575, 1995, 3893, 605, 4895, 5468, 2186,
                        2211, 541, 5772, 2611, 2099, 6014, 261, 1345, 3974, 3152, 5382, 5890, 1155,
                        2021, 6604, 6061, 1743, 3546, 6562, 21, 4970, 3815, 5070, 1379, 1857, 3547,
                        843, 4579, 5694, 4063, 5536, 3713, 447, 5282, 6192, 1289, 1811, 3916, 6174,
                        3371, 1674, 5280, 844, 3456, 290, 4379, 4216, 3925, 5539, 4452, 3068, 925,
                        5489, 2896, 5115, 5861, 2578, 6561, 5970, 1370, 6137, 3770, 2164, 4656,
                        2357, 5053, 4501, 1201, 5632, 2383, 5788, 3526, 1785, 3916, 6094, 5801, 355,
                        2501, 2852, 6581, 3091, 6404, 2641, 3037, 5200, 4524, 991, 3137, 4603, 5767,
                        3152, 5110, 4167, 6294, 5232, 6291, 6068, 3881, 1303, 6039, 4271, 5414,
                        4886, 2114, 3943, 5957, 3493, 5848, 4031, 1920, 5669, 1420, 6019, 4290, 893,
                        2504, 3841, 2525, 126, 4680, 3840, 3108, 6006, 4570, 5166, 4209, 5988, 1973,
                        722, 2964, 3164, 6477, 242, 2788, 2399, 286, 6173, 6035, 4119, 4721, 5004,
                        2911, 5202, 716, 2447, 2306, 1988, 6036, 886, 6617, 186, 3715, 4864, 5366,
                        3201, 1001, 5807, 6365, 6339, 1319, 6289, 165, 5294, 5988, 407, 491, 4454,
                        3927, 6563, 2639, 5898, 2558, 6248, 3502, 1911, 4275, 5162, 5600, 2155,
                        5251, 6573, 5640, 742, 5155, 3791, 5879, 3689, 1891, 6267, 1018, 5910, 1659,
                        3009, 4263, 4531, 1840, 6484, 5944, 6605, 5396, 4783, 5359, 5762, 184, 552,
                        2776, 4507, 4468, 4333, 4369, 1948, 5261, 221, 5370, 5770, 6592, 3645, 1177,
                        3920, 1285, 2924, 1501, 4257, 688, 6474, 3668, 2463, 4688, 2666, 5802, 1220,
                        2553, 63, 6256, 5414, 3972, 5700, 515, 6015, 4186, 3612, 3304, 5050, 4585,
                        147, 492, 189, 1755, 2880, 3380, 2724, 376, 4842, 594, 610, 3928, 5794,
                        1109, 1116, 3086, 2853, 210, 6364, 381, 5347, 5350, 1488, 6030, 4132, 2211,
                        1247, 6021, 935, 2526, 1374, 111, 1454, 4813, 3514, 3964, 5786, 3829, 5959,
                        4285, 299, 5565, 2095, 2726, 5524, 5515, 3302, 5092, 1275, 2348, 2123, 1860,
                        5501, 3723, 355, 1837, 3992, 3310, 2980, 5931, 4038, 2432, 4008, 3364, 5185,
                        1180, 6118, 272, 4382, 1834, 4744, 781, 3676, 4653, 5928, 5956, 5833, 5766,
                        3361, 3348, 1611, 3987, 1430, 5615, 1283, 2175, 1347, 6094, 3994, 1199,
                        2996, 4730, 6292, 5329, 2625, 3861, 5307, 6118, 3858, 4781, 335, 1855, 4399,
                        4977, 2862, 2184, 524, 3333, 1507, 2252, 6652, 4993, 6270, 6336, 4990, 1527,
                        3900, 1492, 6516, 4051, 868, 5647, 3728, 2914, 2498, 4938, 3706, 5094, 4108,
                        6243, 142, 2410, 4631, 6359, 1813, 4868, 4465, 4098, 5641, 2506, 6567, 5882,
                        4385, 3140, 3414, 3537, 4047, 1439, 3475, 6210, 5325, 5389, 877, 4344, 6332,
                        378, 2650, 2994, 3009, 6002, 6120, 6019, 2449, 4508, 2642, 1945, 2676, 5682,
                        5482, 2570, 5054, 6179, 6100, 5352, 6284, 5075, 2362, 4915, 6269, 5147,
                        2685, 1478, 6607, 812, 3314, 5733, 6666, 1468, 3771, 1322, 2130, 3544, 6459,
                        5666, 6577, 3387, 6139, 4296, 5305, 6409, 4355, 4887, 5961, 3217, 5251,
                        2244, 2079, 5440, 3537, 1369, 823, 5291, 5535, 2215, 3296, 4792, 6134, 3404,
                        981, 4765, 3408, 5275, 656, 1308, 3276, 2905, 2503, 3838, 662, 4013, 6489,
                        5802, 1951, 5025, 6011, 6506, 6505, 4842, 6057, 4432, 560, 4657, 490, 880,
                        1235, 1608, 6265, 726, 2014, 4207, 6259, 5540, 4075, 4751, 4587, 1779, 5124,
                        4780, 6175, 5368, 5703, 1088, 2872, 65, 531, 3698, 1636, 4796, 5633, 1017,
                        2467, 6276, 6093, 6604, 2, 5345, 6632, 3115, 3975, 2233, 4388, 6194, 1072,
                        1398, 4608, 6584, 6610, 4861, 4620, 356, 328, 6385, 3751, 2878, 5672, 1932,
                        2951, 605, 6567, 5017, 675, 5191, 1847, 1, 978, 6177, 103, 2513, 4709, 5122,
                        1174, 3401, 2183, 3228, 2143, 5641, 1428, 2875, 5936, 5648, 6112, 5840,
                        4762, 4342, 1069, 899, 963, 514, 1130, 975, 6535, 1739, 5596, 2581, 2922,
                        1145, 3185, 1003, 4940, 1014, 6192, 2434, 3220, 3543, 3264, 2407, 6504,
                        6313, 3074, 5347, 3050, 4574, 111, 99, 6507, 3342, 3727, 6330, 462, 4627,
                        410, 6477, 3255, 1644, 2719, 5043, 451, 6520, 1531, 1376, 3329, 724, 5668,
                        838, 1072, 173, 3508, 39, 5113, 6351, 3123, 6048, 5960, 5227, 6255, 5602,
                        3054, 1849, 3458, 4879, 915, 6332, 587, 2478, 210, 2210, 5771, 3206, 3557,
                        1973, 1918, 402, 731, 391, 677, 5454, 3434, 5045, 2150, 1020, 5825, 1916,
                        3550, 6387, 5155, 1591, 1174, 471, 6399, 3334, 6634, 910, 4801, 3237, 2613,
                        5136, 310, 5139, 2640, 527, 5330, 1074, 5133, 643, 3243, 5113, 2113, 3238,
                        5635, 1569, 4036, 6466, 3218, 4321, 291, 4479, 868, 1003, 3022, 4822, 1185,
                        961, 4062, 3156, 3393, 6198, 2600, 3893, 3389, 2396, 3058, 4542, 3510, 1309,
                        4266, 1665, 5080, 4119, 2983, 367, 862, 5184, 409, 2193, 4452, 798, 1301,
                        5140, 4740, 1084, 4990, 4679, 461, 3421, 3703, 5274, 5437, 1689, 4536, 5916,
                        2821, 1753, 1418, 3181, 882, 3016, 1674, 259, 6364, 6265, 658, 5791, 6293,
                        2229, 1873, 4393, 5817, 5452, 29, 4628, 4482, 473, 5733, 786, 5893, 1863,
                        1362, 4945, 4924, 4856, 2068, 6157, 979, 3905, 2783, 5135, 4338, 4364, 3072,
                        6277, 5972, 184, 3386, 6009, 3830, 3449, 3096, 5977, 2866, 1399, 5201, 6448,
                        4885, 4092, 3932, 692, 3004, 4409, 3269, 2815, 3018, 5004, 922, 4000, 4692,
                        3028, 3396, 1835, 1124, 5055, 1644, 2235, 2273, 3927, 2626, 2154, 2795,
                        2337, 2500, 3171, 4638, 6265, 6641, 3753, 3712, 4118, 2728, 180, 5226, 3865,
                        4372, 4191, 4558, 1230, 1277, 3351, 3483, 3575, 2682, 1238, 6477, 621, 6278,
                        6020, 2995, 4589, 1357, 6159, 2818, 5243, 1942, 3684, 6512, 2483, 3821,
                        5670, 4957, 5636, 6335, 5832, 4612, 1347, 709, 6594, 3264, 5291, 3738, 2454,
                        2074, 688, 836, 2813, 530, 3557, 2894, 326, 3144, 791, 3990, 2839, 5091,
                        2832, 4607, 2099, 1406, 5835, 6027, 1817, 1196, 3184, 1324, 2430, 2141,
                        1218, 5909, 4109, 1044, 2096, 6612, 2609, 5055, 1571, 5438, 688, 5085, 3857,
                        728, 5362, 6448, 3361, 6079, 1178, 2555, 55, 4571, 3758, 6018, 3854, 2481,
                        391, 5176, 4628, 932, 1785, 5735, 636, 5413, 446, 1471, 468, 1308, 592,
                        5309, 874, 3976, 3006, 6303, 942, 1825, 4383, 2950, 3384, 3183, 2443, 1068,
                        1661, 1187, 6046, 5580, 4981, 4782, 5640, 6398, 2742, 5745, 2152, 1217, 939,
                        5411, 4624, 4195, 947, 2408, 1965, 6285, 5562, 2473, 1114, 4929, 4897, 984,
                        2686, 2038, 32, 5365, 4106, 6592, 5564, 5828, 2498, 339, 3552, 6514, 3626,
                        5499, 1572, 3584, 1609, 3597, 4059, 801, 4503, 4577, 3439, 1191, 3488, 637,
                        2626, 382, 2002, 2836, 1254, 1695, 6055, 5014, 5346, 454, 3567, 1819, 625,
                        3316, 2055, 154, 799, 2694, 4358, 3162, 991, 3979, 2005, 680, 3834, 3456,
                        435, 4530, 944, 6396, 1657, 1017, 4629, 5182, 5808, 4528, 4180, 5054, 3333,
                        2634, 5972, 6520, 3795, 6132, 6348, 1390, 3705, 4294, 5572, 4370, 6354, 60,
                        6509, 2531, 1331, 6067, 3384, 4879, 5337, 4449, 5752, 2566, 2027, 1157,
                        5640, 3724, 5058, 3400, 6314, 4620, 539, 5365, 5003, 4582, 4435, 3608, 1273,
                        4857, 5147, 752, 3729, 6642, 1963, 3899, 4424, 4227, 5851, 4687, 4347, 6118,
                        2307, 4239, 4202, 5065, 4350, 2104, 4308, 803, 4028, 1757, 2498, 4139, 6039,
                        6640, 5753, 6265, 2525, 703, 6430, 1908, 5897, 1729, 793, 2760, 5406, 5084,
                        3856, 5469, 646, 5158, 6594, 1167, 5263, 2938, 2939, 4856, 2392, 682, 3210,
                        2810, 6307, 4049, 4871, 2871, 5533, 2686, 2701, 5993, 4513, 4810, 3653,
                        3813, 2651, 4600, 5683, 3920, 3180, 4400, 6113, 5035, 5424, 3047, 2684,
                        2782, 3225, 5347, 6409, 1827, 1669, 1747, 3818, 2612, 2809, 25, 3269, 1915,
                        5865, 1185, 579, 2554, 5063, 4191, 481, 5614, 80, 3743, 1732, 149, 5063,
                        2883, 4815, 4848, 4746, 2811, 4802, 1705, 6621, 3243, 4314, 4565, 3972,
                        5847, 6195, 678, 2007, 3244, 2416, 3716, 6270, 4893, 6332, 5766, 2340, 3101,
                        1581, 6501, 4648, 3775, 6492, 5333, 3289, 236, 5469, 1205, 3454, 2567, 4713,
                        5153, 3254, 4180, 1878, 3762, 955, 6442, 4368, 5043, 5060, 2516, 6597, 4526,
                        4869, 1398, 166, 516, 385, 6670, 1861, 6501, 5064, 2833, 5550, 2447, 6346,
                        3956, 2836, 5716, 5273, 133, 5337, 4617, 3805, 6134, 6322, 4925, 4521, 5267,
                        5525, 5780, 3904, 3154, 4005, 834, 4201, 3131, 3378, 5781, 5663, 5964, 5416,
                        1800, 5381, 3065, 4767, 3219, 314, 745, 4167, 4977, 5154, 668, 1599, 3216,
                        1280, 3465, 520, 4061, 3038, 841, 5031, 4669, 3535, 6219, 1452, 3824, 257,
                        6430, 6418, 3355, 4769, 4710, 1484, 2100, 5062, 5433, 3087, 5230, 4266,
                        2793, 4954, 963, 3041, 5078, 5186, 2010, 2708, 4631, 5870, 4746, 6651, 4430,
                        5654, 5952, 3545, 5854, 5635, 4304, 123, 397, 5068, 3431, 542, 758, 1346,
                        5064, 5992, 2841, 55, 3326, 6316, 4045, 3778, 3647, 6043, 6054, 447, 3440,
                        2807, 958, 3431, 2582, 3738, 3646, 352, 2400, 3929, 976, 1968, 1323, 4998,
                        5664, 2256, 3395, 5608, 526, 2126, 3383, 2541, 3183, 5786, 4786, 1200, 2493,
                        6452, 1564, 2075, 4708, 3325, 3733, 999, 2865, 6576, 2726, 6260, 1944, 3958,
                        2247, 4401, 4543, 4090, 3685, 6097, 4754, 3176, 1939, 4202, 1450, 6129,
                        5998, 2518, 4461, 4186, 2233, 2657, 3229, 6239, 5285, 2897, 2454, 5843,
                        2386, 3576, 5836, 93, 4088, 4863, 6252, 5841, 2763, 3456, 1341, 4521, 4544,
                        6209, 2735, 2787, 275, 1068, 5963, 2848, 5345, 4911, 5280, 2365, 6074, 6644,
                        5080, 5361, 4945, 1149, 2509, 2782, 6425, 720, 6089, 6535, 3633, 5047, 6629,
                        6103, 5446, 5009, 1347, 6665, 1846, 600, 3380, 3231, 2035, 2344, 6475, 679,
                        894, 5488, 2344, 5542, 3171, 4113, 1970, 3583, 3876, 704, 878, 5940, 1010,
                        6161, 1404, 3314, 4868, 2836, 5107, 1514, 5041, 5945, 1523, 473, 3239, 6303,
                        1546, 4736, 5335, 709, 5173, 602, 4848, 1482, 4347, 5052, 4517, 6353, 5614,
                        5060, 4489, 3571, 727, 6421, 1372, 1031, 6609, 3895, 2937, 6112, 2091, 5804,
                        6309, 4031, 4018, 4083, 1282, 3638, 600, 6610, 3916, 3391, 5473, 60, 2252,
                        4069, 643, 5515, 3815, 3045, 2519, 6241, 4861, 647, 6620, 5747, 5387, 761,
                        4595, 6577, 3993, 1504, 5653, 3446, 4429, 2248, 2222, 1955, 2819, 3212, 300,
                        3062, 3340, 550, 3977, 3095, 2843, 5065, 2488, 3804, 5095, 4898, 4567, 4827,
                        1454, 1582, 1777, 3778, 646, 570, 1496, 4451, 3029, 4503, 4930, 6242, 3340,
                        3240, 4026, 5074, 2366, 2435, 1709, 2087, 1389, 1613, 3344, 1653, 6545,
                        3394, 5139, 4265, 4142, 3649, 5074, 198, 4764, 1722, 5928, 3767, 4274, 2073,
                        5145, 546, 774, 872, 2464, 2040, 2693, 1009, 4397, 3885, 3605, 2889, 5563,
                        1994, 2262, 4969, 2726, 5364, 2129, 4548, 1451, 4877, 2575, 1562)));
    System.out.println(isPerfectPeak);
  }
}
